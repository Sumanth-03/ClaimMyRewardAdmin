import{r as t,t as O}from"./index-CuCeFzuJ.js";import{z as T,A,B as K,P as N,L as j}from"./motion-CwrRiElp.js";import{s as U,n as B,l as G,e as D}from"./Views-CoNtp9bU.js";function $(){const e=t.useRef(!1);return T(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function H(){const e=$(),[s,n]=t.useState(0),r=t.useCallback(()=>{e.current&&n(s+1)},[s]);return[t.useCallback(()=>A.postRender(r),[r]),s]}class V extends t.Component{getSnapshotBeforeUpdate(s){const n=this.props.childRef.current;if(n&&s.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function W({children:e,isPresent:s}){const n=t.useId(),r=t.useRef(null),l=t.useRef({width:0,height:0,top:0,left:0});return t.useInsertionEffect(()=>{const{width:p,height:d,top:a,left:h}=l.current;if(s||!r.current||!p||!d)return;r.current.dataset.motionPopId=n;const f=document.createElement("style");return document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${d}px !important;
            top: ${a}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[s]),t.createElement(V,{isPresent:s,childRef:r,sizeRef:l},t.cloneElement(e,{ref:r}))}const M=({children:e,initial:s,isPresent:n,onExitComplete:r,custom:l,presenceAffectsLayout:p,mode:d})=>{const a=K(Y),h=t.useId(),f=t.useMemo(()=>({id:h,initial:s,isPresent:n,custom:l,onExitComplete:o=>{a.set(o,!0);for(const u of a.values())if(!u)return;r&&r()},register:o=>(a.set(o,!1),()=>a.delete(o))}),p?void 0:[n]);return t.useMemo(()=>{a.forEach((o,u)=>a.set(u,!1))},[n]),t.useEffect(()=>{!n&&!a.size&&r&&r()},[n]),d==="popLayout"&&(e=t.createElement(W,{isPresent:n},e)),t.createElement(N.Provider,{value:f},e)};function Y(){return new Map}function q(e){return t.useEffect(()=>()=>e(),[])}const m=e=>e.key||"";function J(e,s){e.forEach(n=>{const r=m(n);s.set(r,n)})}function Q(e){const s=[];return t.Children.forEach(e,n=>{t.isValidElement(n)&&s.push(n)}),s}const ge=({children:e,custom:s,initial:n=!0,onExitComplete:r,exitBeforeEnter:l,presenceAffectsLayout:p=!0,mode:d="sync"})=>{const a=t.useContext(j).forceRender||H()[0],h=$(),f=Q(e);let o=f;const u=t.useRef(new Map).current,E=t.useRef(o),y=t.useRef(new Map).current,R=t.useRef(!0);if(T(()=>{R.current=!1,J(f,y),E.current=o}),q(()=>{R.current=!0,y.clear(),u.clear()}),R.current)return t.createElement(t.Fragment,null,o.map(i=>t.createElement(M,{key:m(i),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:p,mode:d},i)));o=[...o];const b=E.current.map(m),x=f.map(m),z=b.length;for(let i=0;i<z;i++){const c=b[i];x.indexOf(c)===-1&&!u.has(c)&&u.set(c,void 0)}return d==="wait"&&u.size&&(o=[]),u.forEach((i,c)=>{if(x.indexOf(c)!==-1)return;const S=y.get(c);if(!S)return;const F=b.indexOf(c);let C=i;if(!C){const L=()=>{u.delete(c);const _=Array.from(y.keys()).filter(g=>!x.includes(g));if(_.forEach(g=>y.delete(g)),E.current=f.filter(g=>{const v=m(g);return v===c||_.includes(v)}),!u.size){if(h.current===!1)return;a(),r&&r()}};C=t.createElement(M,{key:m(S),isPresent:!1,onExitComplete:L,custom:s,presenceAffectsLayout:p,mode:d},S),u.set(c,C)}o.splice(F,0,C)}),o=o.map(i=>{const c=i.key;return u.has(c)?i:t.createElement(M,{key:m(i),isPresent:!0,presenceAffectsLayout:p,mode:d},i)}),t.createElement(t.Fragment,null,u.size?o:o.map(i=>t.cloneElement(i)))};function X(e){return e==null}var Z=X;const Ce=O(Z);function ee(e,s){for(var n=-1,r=e==null?0:e.length,l=Array(r);++n<r;)l[n]=s(e[n],n,e);return l}var te=ee,ne=U,re=B,se="[object Symbol]";function oe(e){return typeof e=="symbol"||re(e)&&ne(e)==se}var ie=oe,w=G,ue=te,ce=D,ae=ie,fe=1/0,I=w?w.prototype:void 0,P=I?I.toString:void 0;function k(e){if(typeof e=="string")return e;if(ce(e))return ue(e,k)+"";if(ae(e))return P?P.call(e):"";var s=e+"";return s=="0"&&1/e==-fe?"-0":s}var le=k,de=le;function pe(e){return e==null?"":de(e)}var Ee=pe;export{ge as A,te as _,ie as a,Ce as i,Ee as t};
