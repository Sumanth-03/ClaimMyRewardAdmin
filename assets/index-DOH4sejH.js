import{r as u,a as h,j as e,W as N,X as T}from"./index-CuCeFzuJ.js";import{u as d,g as D,s as j,r as F,a as S}from"./index-BE7OhiUZ.js";import{D as R,u as v,c as w,d as y,S as A,o as I,A as K}from"./omit-CqYyriZK.js";import{k as z,l as P,n as _,o as E}from"./motion-CwrRiElp.js";import{I as O,F as H,a as V,b as B,c as M,d as L}from"./formik.esm-DTrUv1Vk.js";import{B as b}from"./Button-s14vX6fw.js";import{D as $}from"./Drawer-BWtMxMIw.js";import"./CampaignRewardTrackingService-D6FBU9so.js";import"./index.esm-DFlYR4h_.js";import"./floating-ui.dom-QgkQT1lH.js";import"./isPlainObject-B8lPRBD6.js";import"./Views-CoNtp9bU.js";import"./toString-DJHwRkS7.js";const q=({row:t})=>{h(),v();const i=N(),n=()=>{i(`/rewardTracking/View/${t.Id}`)};return e.jsx("div",{className:"flex justify-center text-lg",children:e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:n,children:e.jsx(z,{size:20})})})},U=()=>{u.useState([]);const t=u.useRef(null),i=h(),{page:n,limit:c}=d(r=>r.rewardTracking.data.tableData),l=d(r=>r.rewardTracking.data.loading),o=d(r=>r.rewardTracking.data.refresh),m=d(r=>r.rewardTracking.data.TrackingList);u.useEffect(()=>{f()},[n,c,o]);const a=u.useMemo(()=>({page:n,limit:c}),[n,c]),f=()=>{i(D({page:n,count:c}))},p=u.useMemo(()=>[{header:"",id:"actions",cell:r=>e.jsx(q,{row:r.row.original})},{header:"Name",accessorKey:"user_name",enableSorting:!1},{header:"Customer Id",accessorKey:"customerId",enableSorting:!1,cell:r=>{const{id_user:s}=r.row.original;return e.jsx("p",{children:s})}},{header:"Campaign Name",accessorKey:"CampaignName",enableSorting:!1,cell:r=>{const{store:s}=r.row.original;return e.jsx("p",{children:s})}},{header:"Date of Participation",accessorKey:"dateOfParticipation",enableSorting:!0,cell:r=>{const{date_of_participation:s}=r.row.original;return e.jsx("p",{children:s?new Date(s).toLocaleDateString():"N/A"})}},{header:"Advertiser Name",accessorKey:"advertiserName",enableSorting:!1,cell:r=>{const{retailer:s}=r.row.original;return e.jsx("p",{children:s})}},{header:"Reward Amount",accessorKey:"rewardAmount",enableSorting:!1,cell:r=>{const{reward_amt:s}=r.row.original;return e.jsx("p",{children:s?` â‚¹ ${s}`:"N/A"})}},{header:"Phone Number",accessorKey:"phoneNumber",enableSorting:!1,cell:r=>{const{user_phone:s}=r.row.original;return e.jsx("p",{children:s})}},{header:"Notes",accessorKey:"notes",enableSorting:!1,cell:r=>{const{notes:s}=r.row.original;return e.jsx("p",{children:s||"No notes"})}},{header:"Proof",accessorKey:"proof",enableSorting:!1,cell:r=>{const{img_url:s}=r.row.original;return e.jsx("p",{children:s?"Uploaded":"Not Provided"})}}],[]),g=r=>{const s=w(a);s.page=r,i(j(s))},C=r=>{const s=w(a);s.limit=r,s.page=1,i(j(s))};return e.jsx(e.Fragment,{children:e.jsx(R,{ref:t,columns:p,data:m,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:l,pagingData:{pageIndex:a.page,pageSize:a.limit},onPaginationChange:g,onSelectChange:C,fixedColumns:["actions"]})})},W=()=>{const t=h(),i=u.useRef(null);d(a=>a.rewardTracking.data.tableData);const n=d(a=>a.rewardTracking.data.filterData),c=y(l,500);function l(a){typeof a=="string"&&a.length>=1&&o({key:a}),typeof a=="string"&&a.length===0&&o({key:a})}const o=a=>{t(j({...a,page:1,limit:10})),t(D({...a,...n}))},m=a=>{c(a.target.value)};return e.jsx(O,{ref:i,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(P,{className:"text-lg"}),onChange:m})},x=[{label:"null",value:"null"}],k=u.forwardRef(({onSubmitComplete:t},i)=>{h();const n=d(o=>o.rewardTracking.data.filterData),c=d(o=>o.rewardTracking.data.tableData),l=o=>{t==null||t(),I(c,"total")};return e.jsx(H,{enableReinitialize:!0,innerRef:i,initialValues:n,onSubmit:(o,{resetForm:m})=>{l(),setTimeout(()=>{m()},400)},children:({values:o,touched:m,errors:a})=>e.jsx(V,{children:e.jsx(B,{children:e.jsx(M,{label:"filter",invalid:a&&m,errorMessage:"",children:e.jsx(L,{name:"type",children:({field:f,form:p})=>e.jsx(A,{isSearchable:!1,placeholder:"Select",field:f,form:p,options:x,value:x==null?void 0:x.filter(g=>g.value===o),onChange:g=>{p.setFieldValue(f.name,g==null?void 0:g.value)}})})})})})})}),X=({onSaveClick:t,onCancel:i,onReset:n})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-left w-full",children:e.jsx(b,{size:"sm",variant:"solid",onClick:n,children:"Reset"})}),e.jsxs("div",{className:"text-right w-full",children:[e.jsx(b,{size:"sm",className:"mr-2",onClick:i,children:"Cancel"}),e.jsx(b,{size:"sm",variant:"solid",onClick:t,children:"Apply"})]})]}),G=()=>{h();const t=u.useRef(null),[i,n]=u.useState(!1),c=()=>{n(!0)},l=()=>{n(!1)},o=()=>{var a;(a=t.current)==null||a.submitForm()};d(a=>a.rewardTracking.data.tableData);const m=()=>{var a;(a=t.current)==null||a.resetForm()};return e.jsxs(e.Fragment,{children:[e.jsx(b,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(_,{}),onClick:()=>c(),children:"Filter By"}),e.jsx($,{title:"Filter",isOpen:i,footer:e.jsx(X,{onReset:m,onCancel:l,onSaveClick:o}),onClose:l,onRequestClose:l,children:e.jsx(k,{ref:t,onSubmitComplete:l})})]})};k.displayName="FilterForm";const J=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(W,{}),e.jsx(G,{})]});T("rewardTracking",F);const de=()=>{const t=h(),i=d(l=>l.rewardTracking.data.tableData),n=d(l=>l.rewardTracking.data.refresh),c=()=>{const l=w(i);l.page=1,t(j(l)),t(S(n+1))};return e.jsxs(K,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"lg:flex items-center",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Campaign Reward Tracking"}),e.jsx(E,{className:"mx-2 text-2xl text-indigo-900 cursor-pointer",onClick:c})]}),e.jsx(J,{})]}),e.jsx(U,{})]})};export{de as default};
