import{r as h,a as x,j as e,W as N,X as S}from"./index-CuCeFzuJ.js";import{u as c,g as F,s as w,a as v,r as A,b as _}from"./index-CdpwxF2_.js";import{D as K,u as I,c as j,d as M,S as z,o as P,A as O}from"./omit-CqYyriZK.js";import{k as E,l as H,n as L,o as V}from"./motion-CwrRiElp.js";import{I as $,F as B,a as q,b as W,c as X,d as G}from"./formik.esm-DTrUv1Vk.js";import{B as b}from"./Button-s14vX6fw.js";import{D as J}from"./Drawer-BWtMxMIw.js";import"./index.esm-DFlYR4h_.js";import"./floating-ui.dom-QgkQT1lH.js";import"./isPlainObject-B8lPRBD6.js";import"./Views-CoNtp9bU.js";import"./toString-DJHwRkS7.js";const Q=({row:s})=>{x(),I();const o=N(),l=()=>{o(`/merchantRewardTracking/View/${s.Id}`)};return e.jsx("div",{className:"flex justify-center text-lg",children:e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:l,children:e.jsx(E,{size:20})})})},U=()=>{const s=h.useRef(null),o=x(),{page:l,limit:d}=c(a=>a.merchantRewardTracking.data.tableData),n=c(a=>a.merchantRewardTracking.data.loading),i=c(a=>a.merchantRewardTracking.data.refresh),m=c(a=>a.merchantRewardTracking.data.TrackingList),t=[...m].sort((a,r)=>a.priority_level-r.priority_level);c(a=>a.merchantRewardTracking.data.filterData);const f={1:{label:"Critical Issue",bgColor:"bg-red-600"},2:{label:"High Priority",bgColor:"bg-orange-500"},3:{label:"Moderate Priority",bgColor:"bg-yellow-400"},4:{label:"Low Priority",bgColor:"bg-green-500"},5:{label:"Very Low Priority",bgColor:"bg-blue-400"}};h.useEffect(()=>{g()},[l,d,i]);const u=h.useMemo(()=>({page:l,limit:d}),[l,d]),g=()=>{o(F({page:l,count:d}))},k=h.useMemo(()=>[{header:"Priority",accessorKey:"priority",enableSorting:!1,cell:a=>{var y,D;const{priority_level:r}=a.row.original;return e.jsx("p",{className:`${(y=f[r])==null?void 0:y.bgColor} px-5 py-2 rounded-lg text-white`,children:(D=f[r])==null?void 0:D.label})}},{header:"",id:"actions",cell:a=>e.jsx(Q,{row:a.row.original})},{header:"Name",accessorKey:"user_name",enableSorting:!1,cell:a=>{const{user_name:r}=a.row.original;return e.jsx("p",{children:r})}},{header:"Customer Id",accessorKey:"id_user",enableSorting:!1,cell:a=>{const{id_user:r}=a.row.original;return e.jsx("p",{children:r})}},{header:"Store Name",accessorKey:"retailer",enableSorting:!1,cell:a=>{const{retailer:r}=a.row.original;return e.jsx("p",{children:r})}},{header:"Order Date",accessorKey:"purchase_date",enableSorting:!0,cell:a=>{const{purchase_date:r}=a.row.original;return e.jsx("p",{children:r?new Date(r).toLocaleDateString():"N/A"})}},{header:"Order ID",accessorKey:"orderId",enableSorting:!1,cell:a=>{const{order_id:r}=a.row.original;return e.jsx("p",{children:r})}},{header:"Order Amount",accessorKey:"orderAmount",enableSorting:!0,cell:a=>{const{order_amt:r}=a.row.original;return e.jsx("p",{children:r?` ₹ ${r}`:"N/A"})}},{header:"Reward Amount",accessorKey:"rewardAmount",enableSorting:!0,cell:a=>{const{reward_amt:r}=a.row.original;return e.jsx("p",{children:r?` ₹ ${r}`:"N/A"})}},{header:"Total Commission Amount",accessorKey:"totalCommissionAmount",enableSorting:!1,cell:a=>{const{totalCommissionAmount:r}=a.row.original;return e.jsx("p",{children:r?` ₹ ${r}`:"N/A"})}},{header:"Phone Number",accessorKey:"phone",enableSorting:!1,cell:a=>{const{user_name:r}=a.row.original;return e.jsx("p",{children:r})}},{header:"Email",accessorKey:"email",enableSorting:!1,cell:a=>{const{user_email:r}=a.row.original;return e.jsx("p",{children:r})}}],[m]),C=a=>{const r=j(u);r.page=a,o(w(r))},T=a=>{const r=j(u);r.limit=a,r.page=1,o(w(r))};return e.jsx(e.Fragment,{children:e.jsx(K,{ref:s,columns:k,data:t,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:n,pagingData:{pageIndex:u.page,pageSize:u.limit},onPaginationChange:C,onSelectChange:T,fixedColumns:["priority","actions"]})})},Y=()=>{const s=x(),o=h.useRef(null);c(t=>t.merchantRewardTracking.data.tableData);const l=c(t=>t.merchantRewardTracking.data.filterData),d=M(n,500);function n(t){typeof t=="string"&&t.length>=1&&i({key:t}),typeof t=="string"&&t.length===0&&i({key:t})}const i=t=>{s(w({...t,page:1,limit:10})),s(v({...t,...l}))},m=t=>{d(t.target.value)};return e.jsx($,{ref:o,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(H,{className:"text-lg"}),onChange:m})},p=[{label:"null",value:"null"}],R=h.forwardRef(({onSubmitComplete:s},o)=>{x();const l=c(i=>i.merchantRewardTracking.data.filterData),d=c(i=>i.merchantRewardTracking.data.tableData),n=i=>{s==null||s(),P(d,"total")};return e.jsx(B,{enableReinitialize:!0,innerRef:o,initialValues:l,onSubmit:(i,{resetForm:m})=>{n(),setTimeout(()=>{m()},400)},children:({values:i,touched:m,errors:t})=>e.jsx(q,{children:e.jsx(W,{children:e.jsx(X,{label:"filter",invalid:t&&m,errorMessage:"",children:e.jsx(G,{name:"type",children:({field:f,form:u})=>e.jsx(z,{isSearchable:!1,placeholder:"Select a filter",field:f,form:u,options:p,value:p==null?void 0:p.filter(g=>g.value===i),onChange:g=>{u.setFieldValue(f.name,g==null?void 0:g.value)}})})})})})})}),Z=({onSaveClick:s,onCancel:o,onReset:l})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-left w-full",children:e.jsx(b,{size:"sm",variant:"solid",onClick:l,children:"Reset"})}),e.jsxs("div",{className:"text-right w-full",children:[e.jsx(b,{size:"sm",className:"mr-2",onClick:o,children:"Cancel"}),e.jsx(b,{size:"sm",variant:"solid",onClick:s,children:"Apply"})]})]}),ee=()=>{x();const s=h.useRef(null),[o,l]=h.useState(!1),d=()=>{l(!0)},n=()=>{l(!1)},i=()=>{var t;(t=s.current)==null||t.submitForm()};c(t=>t.merchantRewardTracking.data.tableData);const m=()=>{var t;(t=s.current)==null||t.resetForm()};return e.jsxs(e.Fragment,{children:[e.jsx(b,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(L,{}),onClick:()=>d(),children:"Filter By"}),e.jsx(J,{title:"Filter",isOpen:o,footer:e.jsx(Z,{onReset:m,onCancel:n,onSaveClick:i}),onClose:n,onRequestClose:n,children:e.jsx(R,{ref:s,onSubmitComplete:n})})]})};R.displayName="FilterForm";const ae=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(Y,{}),e.jsx(ee,{})]});S("merchantRewardTracking",A);const ge=()=>{const s=x(),o=c(n=>n.merchantRewardTracking.data.tableData);c(n=>n.merchantRewardTracking.data.TrackingList);const l=c(n=>n.merchantRewardTracking.data.refresh),d=()=>{const n=j(o);n.page=1,s(w(n)),s(_(l+1))};return e.jsxs(O,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"lg:flex items-center",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Merchant Reward Tracking"}),e.jsx(V,{className:"mx-2 text-2xl text-indigo-900 cursor-pointer",onClick:d})]}),e.jsx(ae,{})]}),e.jsx(U,{})]})};export{ge as default};
